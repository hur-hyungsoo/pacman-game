<!DOCTYPE html>
<html>
<head>
    <title>팩맨 게임</title>
    <style>
        canvas {
            background: black;
            display: block;
            margin: auto;
        }
        #controls {
            text-align: center;
            margin-top: 10px;
        }
        button {
            width: 50px;
            height: 50px;
            font-size: 20px;
            margin: 5px;
        }
        #restart {
            display: none;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 18px;
            background: yellow;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="500" height="500"></canvas>
    <button id="restart" onclick="restartGame()">다시 시작</button>

    <!-- 방향 버튼 -->
    <div id="controls">
        <button onclick="move('up')">↑</button><br>
        <button onclick="move('left')">←</button>
        <button onclick="move('down')">↓</button>
        <button onclick="move('right')">→</button>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        let pacX, pacY, gameOver;
        let pacSize = 20, speed = 5, pacDirection = "right", mouthOpen = true;
        let ghosts, points;

        function initGame() {
            pacX = 250, pacY = 250, gameOver = false;
            ghosts = [{ x: 100, y: 100, speed: 2 }, { x: 400, y: 300, speed: 2 }];
            points = [];
            for (let i = 0; i < 10; i++) {
                points.push({ x: Math.random() * 450 + 25, y: Math.random() * 450 + 25 });
            }
            document.getElementById("restart").style.display = "none";
        }

        document.addEventListener("keydown", (event) => {
            if (event.key === "ArrowUp") pacDirection = "up";
            if (event.key === "ArrowDown") pacDirection = "down";
            if (event.key === "ArrowLeft") pacDirection = "left";
            if (event.key === "ArrowRight") pacDirection = "right";
        });

        function move(direction) {
            pacDirection = direction;
        }

        function restartGame() {
            initGame();
            update();
        }

        function update() {
            if (gameOver) return;

            if (pacDirection === "up") pacY -= speed;
            if (pacDirection === "down") pacY += speed;
            if (pacDirection === "left") pacX -= speed;
            if (pacDirection === "right") pacX += speed;

            pacX = Math.max(0, Math.min(canvas.width - pacSize, pacX));
            pacY = Math.max(0, Math.min(canvas.height - pacSize, pacY));

            for (let i = points.length - 1; i >= 0; i--) {
                let point = points[i];
                if (Math.abs(pacX - point.x) < 15 && Math.abs(pacY - point.y) < 15) {
                    points.splice(i, 1);
                }
            }

            ghosts.forEach(ghost => {
                if (pacX > ghost.x) ghost.x += ghost.speed;
                if (pacX < ghost.x) ghost.x -= ghost.speed;
                if (pacY > ghost.y) ghost.y += ghost.speed;
                if (pacY < ghost.y) ghost.y -= ghost.speed;

                if (Math.abs(pacX - ghost.x) < 15 && Math.abs(pacY - ghost.y) < 15) {
                    gameOver = true;
                    document.getElementById("restart").style.display = "block";
                    return;
                }
            });

            mouthOpen = !mouthOpen;
            draw();
            setTimeout(update, 100);
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            let angleStart = mouthOpen ? 0.2 * Math.PI : 0;
            let angleEnd = mouthOpen ? 1.8 * Math.PI : Math.PI * 2;
            let angle = pacDirection === "right" ? 0 : pacDirection === "left" ? Math.PI : pacDirection === "up" ? -Math.PI / 2 : Math.PI / 2;

            ctx.beginPath();
            ctx.arc(pacX + pacSize / 2, pacY + pacSize / 2, pacSize / 2, angle + angleStart, angle + angleEnd);
            ctx.lineTo(pacX + pacSize / 2, pacY + pacSize / 2);
            ctx.fillStyle = "yellow";
            ctx.fill();

            ghosts.forEach(ghost => {
                ctx.beginPath();
                ctx.arc(ghost.x + pacSize / 2, ghost.y + pacSize / 2, pacSize / 2, 0, Math.PI * 2);
                ctx.fillStyle = "red";
                ctx.fill();
            });

            ctx.fillStyle = "white";
            points.forEach(point => {
                ctx.beginPath();
                ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        initGame();
        update();
    </script>
</body>
</html>
